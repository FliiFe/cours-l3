\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Formes quadratiques} \\[1em]
    \end{center}
    \tableofcontents
\else
    \chapter{Formes quadratiques}

    \minitoc
\fi
\thispagestyle{empty}

Dans tout le chapitre, $k$ est un corps, et on supposera que les espaces vectoriels sont de dimension finie.

\section{Forme polaire}


\begin{dfn}
    Soit $E$ un  $k$-ev. Une forme quadratique\index{forme quadratique} sur  $E$ est une application  $q:E \longrightarrow k$ telle qu'il existe $\phi \in  \Bil(E)$ telle que $q(x)=\phi(x, x)$ pour tout  $x \in  E$. On note $Q(E)$ le  $k$-ev des formes quadratiques sur  $E$.
\end{dfn}

\begin{rem}
    Si $q \in  Q(E)$ est associée à $\phi\in \Bil(E)$ et si $(e_1, \cdots , e_n)$ est une base de $E$ alors \[q(x)=\phi(x, x)=\sum_{1\leq i,j\leq n}\phi(e_i,e_j)x_ix_j\]
    Une fonction de la forme \[f(x)=\sum_{i,j}a_{i,j}x_ix_j\] est dite polynomiale homogène de degré $2$.
\end{rem}


\begin{dfn}
Dans $k$ de caractéristique différente de $2$, on pose \[
\begin{array}{rrcl}
    \pi:& \Bil(E) & \longrightarrow & Q(E) \\
        & \phi & \longmapsto & \displaystyle (x \longmapsto \phi(x,x))
\end{array}
\] 
\end{dfn}

\begin{prop}
    $\pi$ est linéaire, surjective, et son noyau est exactement $\A(E)$.
\end{prop}

\begin{cor}
On sait $\Bil(E)=\S(E)\oplus \A(E)$, donc $\pi\left|_{\S(E)}\right.$ est un isomorphisme de $\S(E)$ dans $Q(E)$. Si $E$ est de dimension $n$, alors \[\dim Q(E)= \frac{n(n+1)}{2}\]
\end{cor}

\begin{dfn}
    Soit $q$ une forme quadratique. La forme polaire\index{forme polaire} de $q$ est l'unique $\phi \in  \S(E)$ telle que $\forall  x \in  E, q(x)=\phi(x,x)$.
\end{dfn}

\begin{prop}
    Soit $\phi \in  \Bil(E)$ et $q \in  Q(E)$ associée. Alors, la forme polaire de $q$ est \[\phi_s(x, y)=\frac12(\phi(x, y)+\phi(y, x))=\frac12(q(x+y)-q(x)-q(y))\]
    Cette dernière égalité est l'identité de polarisation\index{identité de polarisation}
\end{prop}

\begin{proof}
    $\phi_S$ est symétrique et $\pi(\phi_S)=q$, et \[q(x+y)-q(x)-q(y)= (\cdots )=\phi(x,y)+\phi(y,x)\]
\end{proof}

\begin{dfn}
    Soit $q \in  Q(E)$. Le rang de $q$ est le rang de sa forme polaire. On dit que $q$ est non-dégénérée si et seulement si sa forme polaire est non-dégénérée
\end{dfn}

\begin{prop}
Si $q \in  Q(E)$ et $F$ est un sev de $E$ alors $q\left|_F\right. \in  Q(F)$ et la forme polaire de cette restriction est la restriction de la forme polaire de $q$ à $F\times F$.
\end{prop}

\begin{rem}
Il est possible que $q$ soit non-dégénérée et que $q\left|_{F}\right.$ le soit.
\end{rem}

\section{Matrice d'une forme quadratique}

\begin{dfn}
    Soit $q \in  Q(E)$ et $\mathcal  B$ une base de $E$. La matrice de  $q$ dans la base  $\mathcal  B$ est $\mathcal  M_{\mathcal  B}(\phi)$ où $\phi$ est la forme polaire de  $q$.
\end{dfn}

\begin{ex}
    Prenons $E=k^n$ et  $q:E \longrightarrow k$ avec \[q(x)=\sum_{1\leq i\leq j\leq n}a_{i,j}x_ix_j\]
    Alors, la matrice $M$ de $q$ dans la base canonique est donnée par \[
    \begin{cases}
        M_{i,i}=a_{i,i}\text{ si }1\leq i\leq n\\
        M_{i,j}= \sfrac{a_{i,j}}2 \;\;\text{ si }\;\;i<j, \;\;\sfrac{a_{j,i}}2\;\;\text{ sinon }
    \end{cases}
    \] 
\end{ex}

\begin{prop}
    Soit $q \in  Q(E)$, $\mathcal  B, \mathcal  B'$ des bases de $E$ et $P \in  \GL_n(k)$ la matrice de passage de $\mathcal  B$ à $\mathcal  B'$. Alors $ \mathcal  M_{\mathcal  B'}(q)=\transpose P\mathcal M_{\mathcal  B}(q)P$
\end{prop}

\begin{proof}
Changement de base pour la matrice d'une forme bilinéaire
\end{proof}

\begin{dfn}
    Soit $q \in  Q(E)$ et $\mathcal  B$ une base de $E$. Le discriminant de  $q$ dans la base  $\mathcal  B$ est $\disc_{\mathcal  B}(q)=\det(\mathcal  M_{\mathcal  B}(q)) \in  k$.
\end{dfn}

\begin{rem}
    $q$ est dégénérée  si et seulement si $\disc_{\mathcal  B}(q)=0$
\end{rem}

\begin{dfn}
    On note $k /(k^\times)^2$ le quotient de $k$ par  $\sim$ définie par  \[
    x\sim y \iff  \exists  a \in  k^\times, \quad  x=a^2y
    \]
\end{dfn}

\begin{prop}
    L'image de $\disc_{\mathcal  B}(q)$ dans $k / (k^\times)^2 $ ne dépend pas de la base $ \mathcal B$
\end{prop}

\begin{proof}
 \[
     \det(\mathcal  M_{\mathcal  B'}(q))=\det(P)^2 \det (\mathcal  M_{\mathcal  B}(q))
\] 
\end{proof}

\begin{dfn}
    On note $\disc(q) \in  k / (k^\times)^2 $ l'image de $\disc_{\mathcal  B}(q)$ dans $k / (k^\times )^2 $.
\end{dfn}

\section{Isomorphisme de formes quadratiques}

\begin{dfn}
    Soient $E, E'$ des  ev et $q \in  Q(E), q' \in  Q(E')$. On dit que $q$ et  $q'$ sont isomorphes s'il existe un isomorphisme  $u:E\longrightarrow E'$ tel que $q=q'\circ u$
\end{dfn}

\begin{rem}
    Soient $\mathcal  B, \mathcal  B'$ des bases respectives de $E, E'$. Alors  $q$ et  $q'$ sont isomorphes  si et seulement si $\mathcal  M_{\mathcal  B} (q)$ et $\mathcal  M_{\mathcal  B'}(q')$ sont congruentes (i.e. $ \exists  P \in  \GL_n(k)$ tq $\mathcal M_{\mathcal  B'}(q')=\transpose P\mathcal  M_{\mathcal  B}(q)P$)
\end{rem}

\begin{prop}
    Si $q$ et  $q'$ sont isomorphes, alors elles ont même rang et même discriminant dans $k / (k^\times )^2 $.
\end{prop}

\begin{rem}
Ces invariants ne sont pas suffisant pour classifier les formes quadratiques à isomorphisme près
\end{rem}

\begin{ex}
$E=E'=\R^2 $, $k=\R$ et  \[
\begin{dcases}
    q(x, y)=x^2 +y^2 \\
    q'(x, y)=x^2 -y^2
\end{dcases}
\] 
Dans la base canonique, ces formes ont les matrices respectives $I_2$ et  $-I_2$, donc  $q$ et  $q'$ sont de rang  $2$. De plus,  $\disc(q)=1=\disc(q')$ dans  $ \R / (\R^\times )^2 $. Pourtant, $q$ et  $q'$ n'ont pas la même image (l'une est positive, l'autre non).
\end{ex}

\section{Orthogonalité et noyau}

On considère $q \in  Q(E)$, de forme polaire $\phi$.

 \begin{dfn}
Si $A\subseteq E$, on définit  \[
    A^{\bot,q}=A^{\bot,\phi}=L_\phi(A)^\bot=R_\phi(A)^\bot
\]
\end{dfn}

\begin{dfn}
    Le noyau de $q$ est  $\ker q=E^{\bot,q}= \left\{ x \in  E, \quad  \forall  y \in  E, \phi(x, y)=0 \right\} $. C'est un sev de $E$. On remarque que  $\phi$ est dégénérée  si et seulement si $\ker q\neq \left\{ 0 \right\} $
\end{dfn}

\begin{rem}
Si $F$ est un sev de $E$ alors $\ker (q)\cap F\subset \ker (q\left|_{F}\right.)$, mais il n'y a en général pas égalité en général.
\end{rem}

\begin{prop}
    Soit $V$ un sev de  $E$. Alors  $\dim V+\dim V^\bot \geq \dim E$, avec égalité si $q$ est non-dégénérée
\end{prop}

\begin{proof}
Vu pour les formes bilinéaires
\end{proof}

\begin{rem}
    Si $q$ est non-dégénérée, on n'a pas forcément  $V\oplus V^\bot=E$. Par exemple, pour  $q(x, y)=xy$ dans $k^2$,  $(ke_1)^\bot=ke_1$.
\end{rem}

\begin{prop}
On a $V\oplus V^\bot =E \iff  \disc(q\left|_{V}\right.)\neq 0$
\end{prop}

\begin{proof}
$\impliedby )$ Soit $x \in  V\cap V^\bot$. Alors, $\forall  y \in  V, \phi(x, y)=0$. Puisque $\phi\left|_{V^2}\right.$ est non-dégénérée, cela entraine $x=0$. Puis, la somme des dimensions est bonne.

$\implies )$ Soit $x \in  V$ tel que $\forall  y \in  V, \phi(x, y)=0$. Alors $x \in  V\cap V^\bot$ d'où $x=0$. Donc finalement  $\ker (q\left|_{V}\right.)= \left\{ 0 \right\} $
\end{proof}

\section{Cône isotrope d'une forme quadratique}

\begin{dfn}
    Le cône isotrope\index{cone isotrope@cône isotrope} de $q \in  Q(E)$ est l'ensemble \[
        C(q)= q^{-1}(\left\{ 0 \right\} )
    \]
\end{dfn}

\begin{rem}
\begin{itemize}
    \item $\ker q\subseteq C(q)$ mais il n'y a pas toujours égalité
    \item  $C(q)$ n'est pas un espace vectoriel
    \item  $C(q)$ est stable par multiplication par un scalaire (d'où le nom de cône).
\end{itemize}
\end{rem}

%TODO: rattrapage ici

% TODO: potentiellement titre ici

On se place dans un $ \R$-ev E muni d'un produit scalaire

\begin{thm}
    Soit $u \in  \S(E)$. Alors il existe une base orthonormée de $E$ qui diagonalise  $u$. Réciproquement, si  $u \in  L(E)$ peut être diagonalisée dans une base orthonormée, alors  $u$ est symétrique.
\end{thm}

\begin{lmm}
    Soit $u \in  \S(E)$. Alors ses valeurs propres sont réelles.
\end{lmm}

\begin{lmm}
    Soit $u \in  \S(E)$ et $F\subset E$ stable par  $u$. Alors,  $F^\bot$ est aussi stable par  $u$
\end{lmm}

\begin{proof}[Preuve du second lemme]
    Si $x \in  F^bot, y \in  F$ alo s $ \scalar{u(x)}{y}= \scalar{x}{u(y)}=0  $ donc $u(x)\in F^\bot$
\end{proof}

\begin{proof}[Preuve du théorème]
    Soit $u \in  \S(E)$. On fait une récurrence sur $n=\dim E$. Si  $n=1$, il n'y a rien à faire. Sinon, soit  $x\in  E$ un vecteur propre unitaire de $u$. On pose $F=\R x$ et $E=F\oplus F^\bot$ et  $F^\bot$ est stable par  $u$ donc  $u\left|_{F^\bot}\right.$ se diagonalise dans une base orthonormée, ce qui conclut.
\end{proof}

% TODO: les corollaires de sasha

\begin{cor}
    $u \in  \S(E)$. Alors $q_u(x)= \scalar{u(x)}{x} $ est une forme quadratique. Il existe une base orthonormée directe pour $q_u$
\end{cor}

% TODO: rattraper ça aussi

\section{Décomposition polaire}

\begin{prop}
    Soit $u \in  \S^{++}(E)$. Alors il existe un unique $v \in  \S ^{++}(E)$ tel que $v^2 =u$. Puis, $v$ est polynomial en  $u$.
\end{prop}

\begin{proof}
    Soit $(e_1, \cdots , e_n)$ une BON qui diagonalise $u$:  $ u(e_i)=\lambda_i e_i$. On pose $v(e_i)=\sqrt{\lambda_i}e_i$, on a bien  $v \in  \S ^{++}(E)$.

    Si $P \in  \R[X]$ est tel que $P(\lambda_i)=\sqrt{\lambda_i}$ alors  $P(u)=v$. Pour l'unicité, on se donne  $w$ qui convient. Les applications  $w$ et  $u$ commutent donc il existe une base de diagonalisation commune, et dans cette base on peut identifier les valeurs propres. Puis  $E=\bigoplus E_{\lambda_i}^u$ et  ces espaces propres sont stables par  $w$, puis  $E_{\lambda_i}^u=E_{\sqrt{\lambda_i}}^w$ donc  $v=w$.
\end{proof}

\begin{thm}[Décomposition polaire]
    On se donne $g \in  \GL{E}$. Il existe un unique $u \in  \O(E)$ et $s \in  \S ^{++}(E)$ tels que $g=us$. De plus,  $s$ est un polynôme en  $g^\star=g$
\end{thm}

\begin{proof}
    Remarquons que $h\defeq g^\star g \in  \S ^{++}(E)$, puisque $h^\star=(g^\star g)^\star=g^\star g=h$. Puis, si  $\lambda$ est une valeur propre de  $h$ et  $x$ un vecteur propre associé, alors  \[
        \scalar{h(x)}{x} = \scalar{\lambda x}{x} = \lambda \|x\|^2 = \scalar{g^\star g (x)}{x} = \|g(x)\|^2 
    \] 
    donc $ \lambda >0$. Il existe $s \in \S^{ ++ }(E)$ tel que $s^2 =h$. On pose $u=gs^{-1}$ de sorte que $g=us$. Puis  \[
    u^\star u=s^{-1}g^\star g s^{-1}=s ^{-1} s^2 s ^{-1}=\id
    \] 
    d'où $u \in  \O(E)$, ce qui conclut sur l'existence.

    Pour l'unicité, on peut remarquer que $g^\star g=s^2$ donc  $s$ est uniquement déterminé par  $g$.
\end{proof}
