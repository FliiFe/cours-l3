\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Construction de mesures, mesure de Lebesgue} \\[1em]
    \end{center}
    \tableofcontents
\else
    \chapter{Construction de mesures, mesure de Lebesgue}

    \minitoc
\fi
\thispagestyle{empty}

Dans ce chapitre, on va montrer l'existence et l'unicité de la mesure de Lebesgue $\lambda_d$ sur  $(\R^d, \mathcal  B(\R^d))$ telle que \[
    \forall  a_1<b_1, \cdots , \forall  a_d<b_d, \qquad  \lambda_d \left( \prod_{i=1}^d ]a_i, b_i[ \right)= \prod_{i=1}^{d} (b_i-a_i) 
\]
On va par ailleurs développer des outils généraux très utiles en théorie de l'intégration

\section{Unicité: lemme des classes monotones}

\begin{dfn}
    Une classe monotone\index{classe monotone} sur un ensemble $X$ est une famille  $\mathcal  M\subset \mathcal  P(X)$ telle que \begin{enumerate}
        \item $X \in  \mathcal  M$
        \item Pour tous $A, B \in  \mathcal  M$, $A\subseteq B \implies B \setminus A \in  \mathcal  M$
        \item Pour tout  $A \in  \mathcal  M$, $(A_i\subseteq A_{i+1})\implies \ubigcup_{i\geq 0}A_i \in  \mathcal  M$
    \end{enumerate}
    On parle parfois de $\lambda$-système ou de classes de Dynkin.
\end{dfn}

\begin{lmm}[Lemme de Dynkin ou Lemme $\lambda-\pi$]
    \index{Dynkin (lemme)}\index{lambda-pi@$ \lambda-\pi$ (lemme)} Soit $\mathcal  P\subseteq \mathcal  P(X)$ une famille stable par intersection finie\footnotemark. Alors la plus petite classe monotone $\lambda(\mathcal  P)$ contenant $\mathcal  P$ coïncide avec $\sigma(\mathcal  P)$
\end{lmm}

\footnotetext{on parle alors parfois de $\pi$-système}

\begin{rem}
L'ensemble des classes monotones sur $X$ est stable par intersection.
\end{rem}

\begin{proof}
    On montre que $\lambda(\mathcal  P)$ est stable par intersection finie. Soit $A \in  \mathcal  P$, notons \[
        \mathcal  C_1 = \left\{ B \in  \lambda (\mathcal  P), \quad  \suchthat \quad  A\cap B \in  \lambda (\mathcal  P) \right\} 
    \]
    Alors, $\mathcal  P\subseteq \mathcal  C_1$ et c'est de plus une classe monotone car $X \in  \mathcal  C_1$, si $B\subseteq B'$ dans  $\mathcal C_1$ alors \[
        (B' \setminus B)\cap A = \underbrace{(B'\cap A)}_{\in \lambda(\mathcal  P)} \setminus  \underbrace{(B\cap A)}_{\in  \lambda(\mathcal P)} \in \lambda(\mathcal  P)
    \] 
    donc $B' \setminus B \in \mathcal  C_1$. Finalement, si $(B_i)_i$ est croissante dans  $\mathcal  C_1$ alors \[
        A\cap \left( \ubigcup_{i\geq 0} B_i \right)= \ubigcup_{i\geq 0}(A\cap B_i)
    \] 
    et cette union est croissante donc dans $\lambda(\mathcal  P)$, d'où $\ubigcup B_i \in  \mathcal  C_1$. On a donc $\lambda(\mathcal  P)\subseteq \mathcal  C_1\subseteq \lambda(\mathcal  P)$ donc $\mathcal  C_1 - \lambda(\mathcal  P)$. Par les mêmes arguments, pour $A \in  \lambda(\mathcal  P)$, \[
        \mathcal  C_2 = \left\{ B \in  \lambda(\mathcal  P) \quad \suchthat \quad  A\cap B \in  \lambda(\mathcal  P)  \right\} 
    \] 
    on a $\mathcal  C_2=\lambda(\mathcal  P)$. Ainsi, $\lambda(\mathcal  P)$ est stable par intersection finie, et par complémentation, $\lambda(\mathcal  P)$ est stable par union finie. Si  $(A_i)$ est une suite dans  $\lambda(\mathcal  P)$, on écrit \[
        \bigcup A_i=\ubigcup_{n\geq 1} \left(\bigcup_{i=1}^nA_i\right) \in \lambda(\mathcal  P)
    \] 
    donc $\lambda(\mathcal  P)$ est une $\sigma$-algèbre et donc  $\lambda(\mathcal  P)\subset \sigma(\mathcal  P)$. Comme $\sigma(\mathcal  P)$ est une $\sigma$-algèbre, c'est aussi une classe monotone d'où l'autre inclusion.
\end{proof}

\begin{cor}[Unicité des mesures]
    Soit $\mu$ et  $\nu$ deux mesures que  $(X, \mathcal  A)$ espace mesurable. Soit $\mathcal  P \subseteq \mathcal  P(X)$ une famille stable par intersection finie. Si \begin{itemize}
        \item $\sigma(\mathcal  P)=\mathcal  A$
        \item $\forall  A \in  \mathcal P, \mu(A)=\nu(A)$
        \item $ \exists  X_0\subseteq X_1\subseteq \cdots $ dans $\mathcal  P$ telle que $\mu(X_k)=\nu(X_k)<\infty$ et  $X=\ubigcup X_k$
    \end{itemize}
    alors $\mu=\nu$
\end{cor}

\begin{rem}
    Si $\mu, \nu$ sont finies alors la troisième condition signifie seulement  $\mu(X)=\nu(X)$
\end{rem}

\begin{proof}[Preuve du corrolaire]
    Supposons $\mu(X)$ ($=\nu(X)$) fini. Alors \[
        \mathcal  M= \left\{ A \in  \mathcal  A \;\suchthat\; \mu(A)=\nu(A) \right\} 
    \] 
    est une classe monotone (à vérifier, par exemple $A\subseteq B\implies \mu(B \setminus  A)=\mu(B)-\mu(A)=\nu(B)-\nu(A)=\nu(B \setminus  A)$) donc c'est $\sigma(\mathcal P)=\mathcal  A$. Dans le cas général, on raisonne sur les mesures traces sur les $X_k$.
\end{proof}

\begin{ex}
    La mesure de Lebesgue, si elle existe, est unique. En effet, les pavés forment un $\pi$-système et engendrent  $\mathcal  B(\R^d)$. On peut prendre $X_k=]-k,k[^d$
\end{ex}

\section{Mesures extérieures}

\begin{dfn}
    Une mesure extérieure\index{mesure extérieure} sur un ensemble $X$ est une application  \[
    \begin{array}{rrcl}
        \mu^\star:& \mathcal  P(X) & \longrightarrow &[0, +\infty]  \\
         & E & \longmapsto & \displaystyle \mu^\star(E)
    \end{array}
    \]
    telle que \begin{enumerate}
        \item $\mu^\star(\emptyset)=0$
        \item Si  $A\subseteq B\subseteq X$ alors $\mu^\star(A) \leq \mu^\star (B)$
        \item $\forall  A_1, A_2, \cdots \subseteq X$, \[
                \mu^\star \left(\bigcup_{i\geq 1}A_i\right) \leq \sum \mu^\star(A_i)
        \]
    \end{enumerate}
\end{dfn}

\begin{rem}
    Notons que si $E, A\subseteq X$ et $\mu^\star$ est une mesure extérieure, alors  $\mu(E)\leq \mu(E\cap A)+\mu(E \setminus  A)$
\end{rem}

\begin{dfn}
Une partie $A$ de  $X$ est dite mesurable par rapport à  la mesure extérieure $\mu^\star$ si  \[
    \forall  E \in  \mathcal  P(X), \quad  \mu^\star(E)=\mu^\star(E\cap A)+\mu^\star(E \setminus  A)
\] 
On note $\mathcal  M(\mu^\star)$ l'ensemble des parties $\mu^\star$-mesurables.
\end{dfn}


 \begin{thm}
     Si $\mu^\star$ est une mesure extérieure sur l'ensemble  $X$, alors  $\mathcal M(\mu^\star)$ est une $\sigma$-algèbre et  $\mu^\star$ est une mesure sur $(X, \mathcal  M(\mu^\star ))$
\end{thm}

\begin{lmm}
    Si $\mu^\star(A)=0$ ou  $\mu^\star(A^c)=0$ alors  $A$ est mesurable.
\end{lmm}

\begin{proof}
    Par monotonie, $\mu^\star(E\cap A)+\mu^\star(E\cap A^c)\leq \mu(E)$ (l'un des deux termes de la somme est toujours nul, l'autre est petit)
\end{proof}

\begin{lmm}
    $\mathcal M(\mu^\star)$ est une algèbre.
\end{lmm}

\begin{proof}
    $\emptyset \in  \mathcal  M(\mu^\star)$ par le lemme précédent, la stabilité par complémentaire est évidente. Montrons que c'est stable par union finie. Soient $A_1, A_2 \in  \mathcal M(\mu^\star)$. Alors \[
        \mu^\star(E\cap (A_1\cup A_2))=\mu^\star(E\cap (A_1\cup A_2)\cap A_1)+\mu^\star(E\cap (A_1\cup A_2)\cap A_1^c)=\mu^\star(E\cap A_1)+\mu^\star(E\cap A_2\cap A_1^c)
    \] 
    et \[
        \mu^\star(E\cap (A_1\cup A_2))+\mu^\star(E\cap (A_1\cup A_2)^c) = \mu^\star(E\cap A_1)+\mu^\star(E\cap A_1^c\cap A_2)+\mu^\star(E\cap A_1^c\cap A_2^c)=\mu^\star(E\cap A_1)+\mu^\star(E\cap A_1^c)=\mu^\star(E)
    \] 
\end{proof}

\begin{lmm}
    $\mathcal  M(\mu^\star)$ est stable par union dénombrable d'ensembles deux à deux disjoints.
\end{lmm}

\begin{proof}
    Soit $A_0, \cdots \in \mathcal M(\mu^\star)$ deux à deux disjoints. Montrons que $ \forall  n\geq 0, \forall  E\subseteq X$, \[
        \mu^\star(E)= \sum_{i=0}^{n} \mu^\star(E\cap A_i)+\mu^\star\left(E\cap\left(\bigcup_{i=0}^nA_i\right)^c\right)
    \] 
    C'est vrai par récurrence. % TODO: cette preuve
    Puis, par monotonie, \[
        \mu^\star(E)\geq \sum_{i=0}^n\mu^\star(E\cap A_i)+\mu^\star\left(E\cap \left(\bigcup_{i\geq 0}A_i\right)^c\right)
    \]
    On fait tendre $n\to +\infty$ et par $\sigma$-sous-additivité,  \[
        \mu^\star(E)\geq \sum_{i=0}^{\infty}\mu^\star(E\cap A_i)+\mu^\star\left(E\cap \left(\bigcup_{i\geq 0}A_i\right)^c\right)\geq  \mu^\star\left(E\cap \left(\bigcup_{i\geq 0}A_i\right)\right) + \mu^\star\left(E\cap \left(\bigcup_{i\geq 0}A_i\right)^c\right)
    \] 
    ce qui conclut.
\end{proof}

\begin{proof}[Preuve du théorème]
    Une union dénombrable s'écrit toujours comme union dénombrable d'ensembles disjoints, donc $\mathcal  M(\mu^\star)$. Montrons que $\mu^\star$ est une mesure sur  $\mathcal  M(\mu^\star)$. Avec la dernière inégalité dans la preuve du dernier lemme, pour  des $A_i$ deux à deux disjoints et  $E$ leur union,  \[
        \mu^\star(E)\geq \sum_{i=1}^{+\infty}\mu^\star(A_i)\geq \mu^\star(E)
    \]
\end{proof}

\section{Application à la mesure de Lebesgue}

Fixons $d\geq 1$. On a vu que la mesure de Lebesgue est unique, si elle existe. Soit $E\subseteq \R^d$, notons \[
    \lambda^\star(E)=\inf \left\{ \sum_{i\geq 1}\mathrm{Vol}(P_i) \quad  \suchthat \quad  E\subset \bigcup_{i\geq 1}P_i, \; P_i\text{ pavé ouvert } \right\} 
\] 

\begin{thm}
    $\lambda^\star$ est une mesure extérieure, et  $\mathcal  M(\lambda^\star)\supseteq \mathcal  B(\R^d)$
\end{thm}

\begin{proof}
    La monotonie est claire, $\lambda^\star(\emptyset)=0$ aussi. Soient  $E_1, \cdots \subseteq \R^d$ et soit $(P_i^n)_i$ un recouvrement de $E_n$ par des pavés ouverts de sorte que  \[
        \sum_{i\geq 1}\mathrm{Vol}(P_i^n)\leq \lambda^\star(E_n)+\frac{\epsilon}{2^n}
    \] 
    où $ \epsilon>0$ est fixé. Alors $(P_i^n)_{i,n}$ recouvre $E=\bigcup E_n$ donc \[
        \lambda^\star \left( \bigcup_{n\geq 1}E_n \right) \leq \sum_{n,i\geq 1} \mathrm{Vol}(P_i^n) \leq \sum_{n\geq 1} \left( \lambda^\star(E_n)+ \frac{\epsilon}{2^n} \right)\leq \epsilon + \sum_{n\geq 1}\lambda^\star(E_n)
    \] 
    et comme $\epsilon$ est arbitraire,  $\lambda^\star$ est sous-additive. Montrons que les demi-espaces $D_a=\R^{i-1}\times ]-\infty, a[\times \R^{d-i}$ sont dans $\mathcal  M(\lambda^\star)$, ce qui suffira car cette partie engendre les boréliens. Soit $E \subseteq \R^d$ recouvert par des pavés ouverts $(P_k)_k$. Alors  $(P_k\cap D_a)$ sont des pavés ouverts recouvrant  $E\cap D_a$. Puis si on pose  \[
        P_k'=P_k\cap\left(\R^{i-1}\times \left]a-\frac{\epsilon}{2^kc_k}\right[\times \R^{d-i}\right)
    \]
    avec \[c_k=\prod_{j\neq i}(b_j^{(k)}-a_j^{(k)})\] alors les $P_k'$ sont des pavés ouverts recouvrant  $E\cap D_a^c$ et alors  \begin{align*}
    \lambda^\star(E)\leq \lambda^\star(E\cap D_a)+\lambda^\star(E\cap D_a^c)&\leq \sum_{k\geq 1}\mathrm{Vol}(P_k\cap D_a)+\sum_{k\geq 1}\mathrm{Vol}(P_k')\\&\leq \sum_{k\geq 1}\mathrm{Vol}(P_k\cap D_a)+\mathrm{Vol}(P_k\cap D_a^c)+ \frac{\epsilon}{c_k2^k}c_k\\&\leq \epsilon+\sum_{k\geq 1}\mathrm{Vol}(P_k)
\end{align*}
\end{proof}

\begin{prop}
    Pour tout pavé $P$,  $\lambda^\star(P)=\mathrm{Vol}(P)$
\end{prop}
